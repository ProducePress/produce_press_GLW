<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GLW: Produce Press</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @layer base {
            body {
                font-family: sans-serif;
                background-image: url('https://live.staticflickr.com/7298/14135597212_143ac4eed2_b.jpg');
                background-size: cover;
                background-position: center;
                background-attachment: fixed;
                background-repeat: no-repeat;
                transition: background-position 0.5s ease-in-out;
            }
            body.overflow-hidden {
                overflow: hidden;
            }
        }
        @layer utilities {
            @keyframes scaleIn {
                from {
                    transform: scale(0.95);
                    opacity: 0;
                }
                to {
                    transform: scale(1);
                    opacity: 1;
                }
            }
            .animate-scaleIn {
                animation: scaleIn 0.3s ease-out forwards;
            }
        }
        .body-content-wrapper {
            background-color: rgba(255, 255, 255, 0.7);
            min-height: 100vh;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 6px;
        }
        /* Mobile-specific adjustments for modal */
        @media (max-width: 640px) { /* Tailwind's 'sm' breakpoint */
            #detail-modal > div { /* Target the inner modal content box */
                padding: 1rem; /* Reduce padding on small screens */
                width: 95%; /* Take up more width on small screens */
                max-width: none; /* Remove max-width constraint on small screens */
            }
            #modal-details {
                font-size: 1rem; /* Change text-lg to text-base for mobile */
            }
        }
        /* Reduce motion for users who prefer it */
        @media (prefers-reduced-motion: reduce) {
            .animate-scaleIn { animation: none; }
        }
        /* Mobile: avoid background-attachment: fixed jank */
        @media (max-width: 640px) {
            body { background-attachment: scroll; }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center antialiased">
    <div class="body-content-wrapper">
        
        <!-- Contact Information -->
        <p class="text-lg text-gray-800 mb-2 text-center mt-6">
            Contact Your Specialist: <a href="mailto:greg.hale@gfs.com" class="text-gray-900 hover:underline">Greg Hale (North)</a>
        </p>

        <!-- Page Title -->
        <h1 class="text-5xl font-extrabold text-gray-900 mb-6 text-center leading-tight">
            GLW: Produce Press
        </h1>

        <!-- Grid container for reference items -->
        <div id="reference-items-grid" class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-4 w-full max-w-6xl">
            <!-- Tiles will be inserted here by JavaScript -->
        </div>
        <!-- Loading / Error messages -->
        <div id="loading-message" class="text-gray-700 text-lg mt-4 text-center animate-pulse">Loading produce items…</div>
        <div id="error-message" class="text-red-600 text-lg mt-4 text-center hidden">⚠️ Failed to load produce items. Please try again later.</div>

        <!-- State of the Market Section -->
        <div class="w-full max-w-6xl mt-8 p-6 rounded-xl border border-black bg-green-100 bg-opacity-50">
            <h2 class="text-5xl font-extrabold text-gray-900 mb-4 text-center leading-tight">
                State of The Market
            </h2>
            <p class="text-gray-800 text-lg">
                This week's produce market is in a state of transition, with a mix of easing and elevated prices. Weather continues to be a factor, particularly in key growing regions, while new seasons are ramping up.
                <br><br>
                **Market Conditions:** Overall, markets are easing as the industry moves into September, with some exceptions. Prices for broccoli, oranges, and limes are elevated, while markets for lemons, iceberg lettuce, and chile peppers are inching down as supplies increase. Cantaloupe, celery, cucumbers, grapes, and honeydew markets are stable or low due to ample supply.
                <br><br>
                **Regional Transitions:** The Northwest onion season is off to a strong start, with Washington, Oregon, and Idaho harvests in full swing. Colorado and Utah are also ramping up. In contrast, New Mexico is winding down its season. The California grape season is at its peak, while pear growers are transitioning to new crop Bartletts from Washington.
                <br><br>
                **Supply and Quality:** While many supplies are ample, some items are seeing reduced yields due to scattered showers and quality issues. For instance, broccoli is facing challenges with hollow core and insect damage, while limes are showing stylar and oil spotting. However, most commodities, including cauliflower, celery, and grapes, are reporting very good to excellent quality. Strawberry and raspberry supplies are good with quality remaining strong.
            </p>
        </div>

        <!-- The Recipe Book Section -->
        <div class="w-full max-w-6xl mt-8 p-6 rounded-xl border border-black" style="background-color: rgba(130, 200, 229, 0.5);">
            <h2 class="text-5xl font-extrabold text-gray-900 mb-4 text-center leading-tight">
                The Recipe Book
            </h2>
            <div class="flex flex-col md:flex-row justify-between items-start gap-6">
                <div class="flex-1">
                    <p class="text-gray-800 text-lg">
                        <br>
                        <strong>Grilled Fennel, Corn, and Orange Butter Lettuce Salad with 'Swicy' Tamarind-Lime Dressing</strong>
                        <br><br>
                        This salad combines smoky, charred flavors with hints of sweetness and plenty of crunch—summer on a plate!
                        <br><br>
                        <strong>Ingredients:</strong>
                        <ul class="list-disc list-inside ml-4">
                            <li>2 heads Markon First Crop (MFC) Butter Lettuce</li>
                            <li>4 cobs MFC Corn</li>
                            <li>2 MFC Oranges, peeled and cut into rounds</li>
                            <li>1 MFC Fennel bulb, thinly sliced</li>
                            <li>1 tbsp. vegetable oil</li>
                            <li>1/4 cup MFC Red Onion, sliced</li>
                            <li>3 tbsp. tamarind paste</li>
                            <li>1 tbsp. lime juice</li>
                            <li>2 tbsp. honey</li>
                            <li>1/2 tsp. cayenne pepper</li>
                            <li>1/4 tsp. kosher salt</li>
                        </ul>
                        <br>
                        <strong>Instructions:</strong>
                        <ol class="list-decimal list-inside ml-4">
                            <li>To make the dressing, combine tamarind paste, lime juice, honey, cayenne pepper, and salt in a small bowl. Whisk until well combined. Set aside.</li>
                            <li>Grill corn and fennel, with a little oil, for about 5 minutes or until charred and tender.</li>
                            <li>Carefully remove kernels from the corn cobs and slice the fennel.</li>
                            <li>Arrange butter lettuce leaves on a platter. Top with grilled corn kernels, sliced fennel, orange rounds, and red onion. Drizzle with the swicy tamarind-lime dressing and serve.</li>
                        </ol>
                    </p>
                </div>
                <div class="w-full md:w-1/2 flex-shrink-0">
                    <img src="https://assets.bonappetit.com/photos/594806fbd100ab6f2b218abb/1:1/w_1920,c_limit/grilled-fennel.jpg"
                         alt="A salad with grilled fennel, corn, and orange slices."
                         class="w-full h-auto rounded-lg shadow-md"
                         loading="lazy" decoding="async" width="1920" height="1920">
                </div>
            </div>
        </div>

        <!-- Detailed View Modal -->
        <div id="detail-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 hidden"
             role="dialog" aria-modal="true" aria-labelledby="modal-title" aria-describedby="modal-details">
            <div class="bg-white rounded-xl shadow-2xl p-8 max-w-2xl w-full mx-auto transform scale-95 opacity-0 animate-scaleIn">
                <h2 id="modal-title" class="text-3xl font-bold text-gray-900 mb-4"></h2>
                <p id="modal-details" class="text-gray-700 text-lg mb-6"></p>
                <button id="close-modal-btn" class="w-full bg-indigo-600 text-white py-3 px-6 rounded-lg text-lg font-semibold mt-6
                                                     hover:bg-indigo-700 transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-75">
                    Close
                </button>
            </div>
        </div>
    </div>

    <script>
        (function() {
            let referenceItems = [];

            const gridContainer = document.getElementById('reference-items-grid');
            const detailModal = document.getElementById('detail-modal');
            const modalTitle = document.getElementById('modal-title');
            const modalDetails = document.getElementById('modal-details');
            const closeModalBtn = document.getElementById('close-modal-btn');
            const loadingMessage = document.getElementById('loading-message');
            const errorMessage = document.getElementById('error-message');
            let lastFocusedElement = null;

            const focusableSelectors = 'a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex]:not([tabindex="-1"])';
            function getFocusableElements() {
                return Array.from(detailModal.querySelectorAll(focusableSelectors)).filter(el => el.offsetParent !== null);
            }
            function trapFocus(e) {
                if (e.key !== 'Tab') return;
                const focusable = getFocusableElements();
                if (focusable.length === 0) return;
                const first = focusable[0];
                const last = focusable[focusable.length - 1];
                if (e.shiftKey && document.activeElement === first) {
                    e.preventDefault();
                    last.focus();
                } else if (!e.shiftKey && document.activeElement === last) {
                    e.preventDefault();
                    first.focus();
                }
            }

            function createTiles() {
                gridContainer.innerHTML = '';
                const sortedItems = [...referenceItems];
                sortedItems.sort((a, b) => a.title.localeCompare(b.title));

                sortedItems.forEach(item => {
                    const button = document.createElement('button');
                    button.type = 'button';
                    button.className = `rounded-xl shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1
                                       cursor-pointer overflow-hidden border border-gray-200 flex flex-col items-center justify-center text-center p-4 h-16
                                       ${item.colorClass}`;
                    button.innerHTML = `
                        <h2 class="text-lg font-bold text-gray-800 leading-tight mb-1">${item.title.toUpperCase()}</h2>
                    `;
                    button.addEventListener('click', () => openModal(item));
                    gridContainer.appendChild(button);
                });
                loadingMessage.classList.add('hidden');
            }

            function openModal(item) {
                modalTitle.textContent = item.title.toUpperCase();
                modalDetails.textContent = item.details;
                lastFocusedElement = document.activeElement;
                detailModal.classList.remove('hidden');
                document.body.classList.add('overflow-hidden');
                closeModalBtn.focus();
                detailModal.addEventListener('keydown', trapFocus);
            }

            function closeModal() {
                detailModal.classList.add('hidden');
                document.body.classList.remove('overflow-hidden');
                detailModal.removeEventListener('keydown', trapFocus);
                if (lastFocusedElement && typeof lastFocusedElement.focus === 'function') {
                    lastFocusedElement.focus();
                }
            }

            closeModalBtn.addEventListener('click', closeModal);
            detailModal.addEventListener('click', (event) => {
                if (event.target === detailModal) {
                    closeModal();
                }
            });
            document.addEventListener('keydown', (event) => {
                if (event.key === 'Escape' && !detailModal.classList.contains('hidden')) {
                    closeModal();
                }
            });

            document.addEventListener('DOMContentLoaded', () => {
                fetch('produce.json')
                    .then(response => response.json())
                    .then(data => {
                        referenceItems = data;
                        createTiles();
                    })
                    .catch(err => {
                        console.error('Failed to load produce.json', err);
                        loadingMessage.classList.add('hidden');
                        errorMessage.classList.remove('hidden');
                    });
            });
        })();
    </script>
</body>
</html>

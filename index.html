<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>GLW: Produce Press</title>

  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Roboto Condensed Font -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:wght@400;700&display=swap" rel="stylesheet"/>

  <style>
    @layer base {
      body {
        font-family: 'Roboto Condensed', sans-serif;
        background-image: url('https://live.staticflickr.com/7298/14135597212_143ac4eed2_b.jpg');
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        background-repeat: no-repeat;
        transition: background-position 0.5s ease-in-out;
      }
      body.overflow-hidden { overflow: hidden; }
    }
    @layer components {
      .symbol-box { @apply bg-gray-100 border border-gray-300 rounded-md p-1 px-2 inline-flex items-center justify-center gap-1 text-xs; }
    }
    @layer utilities {
      @keyframes scaleIn { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } }
      .animate-scaleIn { animation: scaleIn 0.3s ease-out forwards; }
    }
    .body-content-wrapper {
      background-color: rgba(255,255,255,0.7);
      min-height: 100vh; width: 100%;
      display: flex; flex-direction: column; align-items: center; padding: 6px;
    }
    /* Mobile modal */
    @media (max-width: 640px) {
      #detail-modal > div { padding: 1rem; width: 95%; max-width: none; }
      #modal-details { font-size: 1rem; }
    }
    /* Simple prose styling for lists */
    .prose-like ul { list-style: disc; margin-left: 1.25rem; }
    .prose-like ol { list-style: decimal; margin-left: 1.25rem; }
    .prose-like li { margin: 0.25rem 0; }
    .prose-like p { margin: 0.5rem 0; }
  </style>
</head>

<body class="min-h-screen flex flex-col items-center antialiased">
  <div class="body-content-wrapper">

    <!-- Contact Information (optional static) -->
    <p class="text-lg text-gray-800 mb-2 text-center mt-6">
      Contact Your Specialist:
      <a href="mailto:greg.hale@gfs.com" class="text-gray-900 hover:underline">Greg Hale (North)</a> |
      <a href="mailto:tracy.ballard@gfs.com" class="text-gray-900 hover:underline">Tracy Ballard (South)</a>
    </p>

    <!-- Page Title -->
    <h1 id="page-title" class="text-5xl font-extrabold text-gray-900 mb-2 text-center leading-tight">GLW: Produce Press</h1>
    <p id="report-date" class="text-sm text-gray-700 mb-4"></p>

    <!-- Grid container for reference items -->
    <div id="reference-items-grid" class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-4 w-full max-w-6xl"></div>

    <!-- State of the Market Section -->
    <div class="w-full max-w-6xl mt-8 p-6 rounded-xl border border-black bg-green-100 bg-opacity-50">
      <h2 class="text-5xl font-extrabold text-gray-900 mb-4 text-center leading-tight">State of The Market</h2>
      <div id="state-of-market" class="text-gray-800 text-lg prose-like"></div>
    </div>

    <!-- The Recipe Book Section -->
    <div class="w-full max-w-6xl mt-8 p-6 rounded-xl border border-black" style="background-color: rgba(130, 200, 229, 0.5);">
      <h2 class="text-5xl font-extrabold text-gray-900 mb-4 text-center leading-tight">The Recipe Book</h2>
      <div class="flex flex-col md:flex-row justify-between items-start gap-6">
        <div class="flex-1">
          <h3 id="recipe-title" class="text-2xl font-bold text-gray-900"></h3>
          <ul id="recipe-ingredients" class="list-disc list-inside ml-4 mt-3"></ul>
          <ol id="recipe-instructions" class="list-decimal list-inside ml-4 mt-3"></ol>
        </div>
        <div class="w-full md:w-1/2 flex-shrink-0">
          <img id="recipe-image" src="" alt="Recipe image" class="w-full h-auto rounded-lg shadow-md hidden">
        </div>
      </div>
    </div>

    <!-- Detailed View Modal -->
    <div id="detail-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 hidden" role="dialog" aria-modal="true" aria-labelledby="modal-title">
      <div class="bg-white rounded-xl shadow-2xl p-8 max-w-2xl w-full mx-auto transform scale-95 opacity-0 animate-scaleIn">
        <h2 id="modal-title" class="text-3xl font-bold text-gray-900 mb-4"></h2>
        <p id="modal-details" class="text-gray-700 text-lg mb-6"></p>
        <button id="close-modal-btn" class="w-full bg-indigo-600 text-white py-3 px-6 rounded-lg text-lg font-semibold mt-6 hover:bg-indigo-700 transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-75">Close</button>
      </div>
    </div>
  </div>

  <!-- ===== Embedded JSON data (no separate files needed) ===== -->
  <script id="report-data" type="application/json">
  {
    "report_date": "2025-09-21",
    "source": "Fresh Crop Report",
    "state_of_market": "- **Onions:** Fresh-run supplies plentiful across WA/OR/ID/UT/CO; markets steady at lower levels.  \n- **Potatoes:** New-crop Norkotahs being harvested through mid-October; quality excellent with minor fresh-run issues.  \n- **Berries:**  \n  - Blueberries: Prices elevated as PNW winds down; Peru ramping, Mexico delayed.  \n  - Strawberries: Prices inching up; Salinas/Watsonville ending, Santa Maria ramping.  \n  - Blackberries: Stable with strong CA/MX supply; quality very good.  \n  - Raspberries: Prices low, yields ample in CA and Baja.  \n- **Leaf & Lettuce:** Iceberg, Green Leaf, and Romaine generally easing; supplies strong in Salinas/Santa Maria though heat/pests remain watchpoints.  \n- **Melons:** Cantaloupe and Honeydew steady with excellent sugars (14–16° Brix); San Joaquin ending, desert transition in ~1 month.  \n- **Avocados:** Prices low with abundant Mexican volume; CA and Peru nearly finished.  \n- **Citrus:** Lemons remain tight and elevated until new CA crop mid-October; Valencia oranges scarce, Navels due late October.  \n- **Grapes:** Markets weak on abundant California supply; quality strong (13–16° Brix).  \n- **Tree Fruit:** Nectarines finishing; peaches and plums plentiful through mid-October.",
    "recipe": {
      "title": "Kale- and Chard-Stuffed Portabella Mushrooms",
      "ingredients": [
        "4 large MFC Portabella Mushrooms, stems removed",
        "3 T olive oil",
        "8 oz. RSS Shredded Kale",
        "4 oz. rainbow chard, chopped",
        "1/4 C pine nuts, toasted",
        "1/4 C Fontina cheese, grated",
        "Salt and pepper, to taste"
      ],
      "instructions": [
        "Preheat oven to 400°F/204°C. Using one tablespoon of olive oil, brush equal amounts on the outside of each mushroom.",
        "Heat the remaining three tablespoons of oil in a sauté pan. Cook kale and chard until wilted; season with salt and pepper.",
        "Fill each mushroom cap with an equal portion of greens. Top with one tablespoon each pine nuts and cheese.",
        "Bake until cheese is bubbly and mushrooms are tender. Serve immediately."
      ],
      "image_url": ""
    },
    "contacts": [],
    "commodities": [
      { "id":"apples","title":"Apples","summary":"Markets fairly steady as Washington storage season ends and new-crop harvests begin in Michigan and Washington. Quality excellent; sugars ~12–13° Brix (MI) and 14–18° Brix (WA). MFC Gala, Golden Delicious, Granny Smith, Fuji, and Red Delicious available." },
      { "id":"asparagus","title":"Asparagus","summary":"Prices decreasing as large/jumbo supplies increase. Baja primary region through early October; high quality. Sonora late September; Peru improving East Coast availability. MFC Asparagus on the market." },
      { "id":"avocados","title":"Avocados","summary":"Prices are low; Mexican volume flooding all sizes. California & Peru ending in ~3 weeks. Value-added items available." },
      { "id":"bell-peppers","title":"Bell Peppers","summary":"Prices inching down. Green bell yields sufficient; California red bells increasing; Central Mexico in full production. MFC & ESS available." },
      { "id":"blackberries","title":"Blackberries","summary":"Market level with strong CA/MX supply; very good quality." },
      { "id":"blueberries","title":"Blueberries","summary":"Prices elevated as PNW passes peak; Peru arrivals starting; Mexico delayed by rain/cool weather." },
      { "id":"broccoli","title":"Broccoli","summary":"Markets have peaked; supplies easing slightly; pest pressure persists. Quality fair–good." },
      { "id":"cantaloupe","title":"Cantaloupe","summary":"Steady; supplies tightening as San Joaquin winds down; excellent flavor ~14–16° Brix. Desert transition in ~1 month." },
      { "id":"cauliflower","title":"Cauliflower","summary":"Wide pricing range but overall steady at lower–average; heat/humidity may cause discoloration/mold." },
      { "id":"celery","title":"Celery","summary":"Prices rising; reduced Salinas plantings and disease. Oxnard starts Nov; Michigan through Oct. Quality excellent." },
      { "id":"chile-peppers","title":"Chile Peppers","summary":"Markets stable; Jalapeño/Pasilla abundant; Serrano tight. Baja rain affected some lots; culling damage." },
      { "id":"cucumbers","title":"Cucumbers","summary":"Level in Baja, active in Central Mexico; East Coast/Midwest steady." },
      { "id":"grapes","title":"Grapes","summary":"Market weak with abundant CA supply; quality very good ~13–16° Brix." },
      { "id":"green-leaf","title":"Green Leaf","summary":"Prices weak; plentiful supplies in Salinas/Santa Maria." },
      { "id":"honeydew","title":"Honeydew","summary":"Steady; supplies tightening as San Joaquin winds down; excellent ~14–16° Brix. Desert transition in ~1 month." },
      { "id":"iceberg","title":"Iceberg","summary":"Prices inching down as supplies increase in Salinas/Santa Maria; East Coast tighter on lack of rain." },
      { "id":"lemons","title":"Lemons","summary":"Tight stocks/elevated markets until mid-Oct when new CA supplies begin." },
      { "id":"limes","title":"Limes","summary":"Prices inching down as seasonal demand slows; quality average; stylar end rot possible." },
      { "id":"onions","title":"Onions","summary":"Fresh-run plentiful WA/OR/ID/UT/CO; markets steady at lower levels; quality good–excellent." },
      { "id":"oranges","title":"Oranges","summary":"Prices increasing; CA Valencia scarce through mid-Oct; Navels expected late Oct." },
      { "id":"pears","title":"Pears","summary":"Unchanged; new-crop WA Bartlett/Bosc/D’Anjou shipping; CA ends late Oct; sugars ~14–18° Brix." },
      { "id":"pineapples","title":"Pineapples","summary":"Prices elevated; new-crop Costa Rica season underway; sugars ~14° Brix." },
      { "id":"red-and-yellow-potatoes","title":"Red and Yellow Potatoes","summary":"Level; fresh-run from ID/WA/WI; CO starting; ND early Oct; MN ends soon; excellent quality with typical early-season skinning/moisture." },
      { "id":"raspberries","title":"Raspberries","summary":"Markets low; ample yields in CA and Baja; quality very good." },
      { "id":"romaine","title":"Romaine","summary":"Prices weak; plentiful in Salinas/Santa Maria; quality average with heat-related issues possible." },
      { "id":"salads-and-blends","title":"Salads & Blends","summary":"Unchanged; West Coast stocks abundant; heatwave may modestly increase defects; quality good." },
      { "id":"spring-mix","title":"Spring Mix","summary":"Steady; Salinas Valley plentiful; very good quality; heat may reduce shelf-life." },
      { "id":"squash","title":"Squash","summary":"Level; Fresno winding down, Santa Maria through late Oct; Baja steady; Sonora mid-Oct; quality very good." },
      { "id":"strawberries","title":"Strawberries","summary":"Inching up; Salinas/Watsonville wrapping; Santa Maria fall crop starting." },
      { "id":"tomatoes","title":"Tomatoes","summary":"Stable; CA sufficient; recent heat moved sizes to med–large; Baja/Central MX adequate through Sept." },
      { "id":"tree-fruit","title":"Tree Fruit","summary":"Nectarines up; season ends 7–10 days; peaches/plums ample through mid-Oct; ~11–14° Brix; Chile starts mid-Jan." },
      { "id":"watermelon","title":"Watermelon","summary":"Weak prices; high volume both coasts; minis ample; excellent quality ~10+° Brix." }
    ]
  }
  </script>

  <!-- ===== App Script ===== -->
  <script>
    (function () {
      // Elements
      const gridContainer = document.getElementById('reference-items-grid');
      const detailModal = document.getElementById('detail-modal');
      const modalTitle = document.getElementById('modal-title');
      const modalDetails = document.getElementById('modal-details');
      const closeModalBtn = document.getElementById('close-modal-btn');

      const stateEl = document.getElementById('state-of-market');
      const recipeTitle = document.getElementById('recipe-title');
      const recipeIngredients = document.getElementById('recipe-ingredients');
      const recipeInstructions = document.getElementById('recipe-instructions');
      const recipeImage = document.getElementById('recipe-image');
      const reportDateEl = document.getElementById('report-date');

      // Read embedded JSON
      const raw = document.getElementById('report-data').textContent;
      const data = JSON.parse(raw);

      // Helper: very small Markdown-to-HTML for bullet lists (supports "- " and two-space indent "  - ")
      function renderBullets(md) {
        const lines = md.split(/\r?\n/);
        let html = '';
        const stack = [];
        for (let ln of lines) {
          if (!ln.trim()) continue;
          const m2 = ln.match(/^\s{2}-\s+(.*)/);     // nested
          const m1 = ln.match(/^\-\s+(.*)/);         // top-level
          if (m1 && !m2) {
            // close nested lists if any
            while (stack.length) { html += '</ul>'; stack.pop(); }
            if (!stack.length || stack[stack.length-1] !== 'ul-root') { html += '<ul>'; stack.push('ul-root'); }
            html += `<li>${m1[1]}</li>`;
          } else if (m2) {
            if (!stack.length) { html += '<ul>'; stack.push('ul-root'); }
            if (stack[stack.length-1] !== 'ul-nested') { html += '<ul>'; stack.push('ul-nested'); }
            html += `<li>${m2[1]}</li>`;
          } else {
            // plain line -> paragraph
            while (stack.length) { html += '</ul>'; stack.pop(); }
            html += `<p>${ln}</p>`;
          }
        }
        while (stack.length) { html += '</ul>'; stack.pop(); }
        return html;
      }

      // Populate header date
      if (data.report_date) {
        const dt = new Date(data.report_date);
        const pretty = dt.toLocaleDateString(undefined, { year:'numeric', month:'short', day:'numeric' });
        reportDateEl.textContent = `Week of ${pretty}`;
      }

      // State of Market
      if (data.state_of_market) {
        stateEl.innerHTML = renderBullets(data.state_of_market);
      }

      // Recipe
      if (data.recipe) {
        recipeTitle.textContent = data.recipe.title || '';
        (data.recipe.ingredients || []).forEach(i => {
          const li = document.createElement('li'); li.textContent = i; recipeIngredients.appendChild(li);
        });
        (data.recipe.instructions || []).forEach(i => {
          const li = document.createElement('li'); li.textContent = i; recipeInstructions.appendChild(li);
        });
        if (data.recipe.image_url) {
          recipeImage.src = data.recipe.image_url;
          recipeImage.classList.remove('hidden');
        }
      }

      // Commodities grid
      const commodities = (data.commodities || []).slice().sort((a,b)=>a.title.localeCompare(b.title));
      gridContainer.innerHTML = '';
      commodities.forEach(item => {
        const tile = document.createElement('div');
        tile.className = 'rounded-xl shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1 cursor-pointer overflow-hidden border border-gray-200 flex flex-col items-center justify-center text-center p-4 h-16 bg-white';
        tile.innerHTML = `<h2 class="text-lg font-bold text-gray-800 leading-tight mb-1">${item.title.toUpperCase()}</h2>`;
        tile.onclick = ()=> openModal(item);
        gridContainer.appendChild(tile);
      });

      function openModal(item) {
        modalTitle.textContent = (item.title || '').toUpperCase();
        modalDetails.textContent = item.summary || '';
        detailModal.classList.remove('hidden');
        document.body.classList.add('overflow-hidden');
      }
      function closeModal() {
        detailModal.classList.add('hidden');
        document.body.classList.remove('overflow-hidden');
      }
      closeModalBtn.addEventListener('click', closeModal);
      detailModal.addEventListener('click', e => { if (e.target === detailModal) closeModal(); });
      document.addEventListener('keydown', e => { if (e.key === 'Escape' && !detailModal.classList.contains('hidden')) closeModal(); });
    })();
  </script>
</body>
</html>
